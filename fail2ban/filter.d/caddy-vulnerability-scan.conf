[Definition]
# Ban requests for well-known malicious/probing paths (exclude ACME)
# Add/remove lines to tune for your environment
failregex = ^.*"uri"\s*:\s*"/(?:\.env|\.git/|\.git$|\.htaccess|\.DS_Store)[^"]*".*(?:"Cf-Connecting-Ip"\s*:\s*\[\s*"(?P<host>[^"]+)"\s*\]|"request"\s*:\s*\{[^}]*"remote_ip"\s*:\s*"(?P<host>[^"]+)"[^}]*\}).*$
            ^.*"uri"\s*:\s*"/(?:wp-login\.php|wp-admin(?:/|$)|xmlrpc\.php|wp-json/)[^"]*".*(?:"Cf-Connecting-Ip"\s*:\s*\[\s*"(?P<host>[^"]+)"\s*\]|"request"\s*:\s*\{[^}]*"remote_ip"\s*:\s*"(?P<host>[^"]+)"[^}]*\}).*$
            ^.*"uri"\s*:\s*"/(?:phpmyadmin|adminer\.php|pma)(?:/|$)[^"]*".*(?:"Cf-Connecting-Ip"\s*:\s*\[\s*"(?P<host>[^"]+)"\s*\]|"request"\s*:\s*\{[^}]*"remote_ip"\s*:\s*"(?P<host>[^"]+)"[^}]*\}).*$
            ^.*"uri"\s*:\s*"/(?:\.vscode|vendor/phpunit|telescope|laravel\.log|config\.json|id_rsa|composer\.(?:json|lock))[^"]*".*(?:"Cf-Connecting-Ip"\s*:\s*\[\s*"(?P<host>[^"]+)"\s*\]|"request"\s*:\s*\{[^}]*"remote_ip"\s*:\s*"(?P<host>[^"]+)"[^}]*\}).*$
            ^.*"uri"\s*:\s*"/(?:jmxconsole|manager/html|actuator|console|hudson|jenkins|CFIDE|solr)(?:/|$)[^"]*".*(?:"Cf-Connecting-Ip"\s*:\s*\[\s*"(?P<host>[^"]+)"\s*\]|"request"\s*:\s*\{[^}]*"remote_ip"\s*:\s*"(?P<host>[^"]+)"[^}]*\}).*$
            ^.*"uri"\s*:\s*"/(?:HNAP1|boaform|Autodiscover/Autodiscover\.xml)(?:/|$)[^"]*".*(?:"Cf-Connecting-Ip"\s*:\s*\[\s*"(?P<host>[^"]+)"\s*\]|"request"\s*:\s*\{[^}]*"remote_ip"\s*:\s*"(?P<host>[^"]+)"[^}]*\}).*$
ignoreregex = ^.*"uri"\s*:\s*"/\.well-known/acme-challenge/[^"]*".*$
